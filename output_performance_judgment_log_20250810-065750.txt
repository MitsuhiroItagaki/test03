================================================================================
ðŸ“Š Weighted System Detailed Analysis Log
================================================================================

ðŸŽ¯ Metric Weight Settings:
   Data Processing                : 25.00% (0.250)
   Operation Complexity           : 20.00% (0.200)
   Memory Efficiency              : 20.00% (0.200)
   Spill Management               : 15.00% (0.150)
   Parallelism                    : 12.00% (0.120)
   Partitioning Efficiency        : 8.00% (0.080)

ðŸ“Š Component Ratio Analysis:
   Data Processing           : 1.0000 (+0.0%)
   Operation Complexity      : 0.8333 (-16.7%)
   Memory Efficiency         : 0.8061 (-19.4%)
   Spill Management          : 0.7522 (-24.8%)
   Parallelism               : 1.0000 (+0.0%)
   Partitioning Efficiency   : 0.2000 (-80.0%)

ðŸ§® Final Judgment Calculation:
   Base Comprehensive Ratio : 0.8267
   Spill Adjustment Factor  : 1.000
   Final Comprehensive Ratio: 0.8267
   Final Improvement Rate  : +17.33%

ðŸŽ¯ Final Judgment Result:
   Judgment Level      : âœ… Significant Improvement (SIGNIFICANT)
   Recommended Action  : Recommend using optimized query
   Judgment Basis      : Determined by final ratio 0.8267

ðŸ“‹ Detailed Metrics:
   Data Size Ratio           : 1.0000 (+0.0%)
   Rows Ratio                : 1.0000 (+0.0%)
   Scan Ratio                : 1.0000 (+0.0%)
   Join Ratio                : 0.6667 (-33.3%)
   Memory Ratio              : 1.0000 (+0.0%)
   Spill Risk Ratio          : 0.6768 (-32.3%)
   Estimated Spill Ratio     : 0.6304 (-37.0%)
   Memory Pressure Ratio     : 0.6667 (-33.3%)
   Spill Probability Ratio   : 1.0000 (+0.0%)
   Shuffle Ratio             : 1.0000 (+0.0%)
   Hash Partition Ratio      : 0.0000 (-100.0%)
   Total Partition Ratio     : 0.0002 (-100.0%)

ðŸ§¾ Queries Used In Judgment:

[Original Query]
SELECT /*+ SHUFFLE_HASH(T2) */
  T1.ID, 
  T2.val,
  T1.cs_net_paid
FROM detail_itagaki as T1
JOIN master_itagaki as T2
  ON T1.ID = T2.ID
ORDER BY 2 desc
limit 10

[Optimized Query]
SELECT
  T1.ID, 
  T2.val,
  T1.cs_net_paid
FROM detail_itagaki as T1
JOIN master_itagaki as T2
  ON T1.ID = T2.ID
ORDER BY 2 DESC
LIMIT 10
